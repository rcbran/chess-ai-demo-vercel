# Chess AI Demo - Cursor Rules

## GitHub Repository Info
- **Owner:** rcbran
- **Repo:** chess-ai-demo-vercel

## Terminal Commands
- **Working Directory:** The shell is already initialized in the workspace root. Do NOT include `cd` commands to the repo root unless switching from a different directory context.
- **Node.js Version:** This project uses `.nvmrc` to specify Node.js 25.2.1. If terminal commands show a different Node.js version, it's because the shell session doesn't auto-load nvm. The user's IDE/terminal should handle this automatically, but command outputs may show a different version if nvm isn't loaded in that shell session.

## CodeRabbit PR Review Workflow

When asked to review or fix CodeRabbit comments on a PR, use these commands:

### 1. List All Review Comments on a PR
```bash
gh api repos/rcbran/chess-ai-demo-vercel/pulls/{PR_NUMBER}/comments --jq '.[] | "\(.created_at) | \(.path):\(.line) | \(.body[0:200])..."'
```

### 2. Get Full Details of Comments (with truncated body)
```bash
gh api repos/rcbran/chess-ai-demo-vercel/pulls/{PR_NUMBER}/comments --jq '.[] | "---\nFILE: \(.path):\(.line)\nBODY: \(.body[0:600])\n"'
```

### 3. Filter by Date (for latest review cycle)
```bash
gh api repos/rcbran/chess-ai-demo-vercel/pulls/{PR_NUMBER}/comments --jq '.[] | select(.created_at >= "YYYY-MM-DDTHH:MM:SSZ") | "---\nFILE: \(.path):\(.line)\nBODY: \(.body[0:600])\n"'
```

### 4. Count Total Comments
```bash
gh api repos/rcbran/chess-ai-demo-vercel/pulls/{PR_NUMBER}/comments | jq 'length'
```

### 5. Get Comments Sorted by Date (newest first)
```bash
gh api repos/rcbran/chess-ai-demo-vercel/pulls/{PR_NUMBER}/comments --jq '.[] | "\(.created_at) | \(.path):\(.line) | \(.body[0:120])..."' | sort -r
```

## CodeRabbit Comment Severity Levels
- ðŸ”´ **Critical** - Must fix before merge
- ðŸŸ  **Major** - Should fix, potential bugs
- ðŸŸ¡ **Minor** - Nice to have, style/naming issues
- ðŸ’­ **Nitpick** - Optional suggestions

## Workflow Tips
1. First get comment count to understand scope
2. Sort by date to identify which comments are from the latest review cycle
3. Group fixes by file to minimize context switching
4. Run tests after each fix: `bun test`
5. Check for lint errors: `bun run lint`

## Post-PR Review Workflow

After publishing a PR, follow this workflow to handle CodeRabbit reviews:

1. **Wait 5 minutes** after creating/updating the PR for CodeRabbit to complete its review
2. **Check for unresolved comments** using the commands above
3. **Address any comments** found (fix code, respond to questions)
4. **Push fixes** if any changes were made
5. **Ask user:** "CodeRabbit comments addressed. Wait another 5 minutes for re-review? (y/n)"
   - If **y**: Wait 5 minutes and repeat from step 2
   - If **n**: Proceed with merge or next steps

This ensures all automated review feedback is addressed before merging.

## Pre-Commit Requirements

**ALWAYS run these checks before committing and pushing code:**

1. **Linter:** `bun run lint` - Must pass with no errors
2. **Tests:** `bun test` - All tests must pass
3. **Build:** `bun run build` - Build must complete successfully

**Workflow:**
```bash
# Before every commit/push, run:
bun run lint && bun test && bun run build
```

If any of these fail, **DO NOT commit or push**. Fix the issues first, then re-run the checks.

## Project Commands
- **Dev server:** `bun dev`
- **Build:** `bun run build`
- **Test:** `bun test`
- **Lint:** `bun run lint`
